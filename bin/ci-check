#!/bin/bash

echo "ğŸ” Running CI checks locally..."
echo "================================"

echo "ğŸ“Š 1. Running Brakeman security scan..."
if ! bin/brakeman --no-pager; then
    echo "âŒ Brakeman failed!"
    exit 1
fi
echo "âœ… Brakeman passed!"
echo ""

echo "ğŸ” 2. Running Importmap audit..."
if ! bin/importmap audit; then
    echo "âŒ Importmap audit failed!"
    exit 1
fi
echo "âœ… Importmap audit passed!"
echo ""

echo "ğŸ¨ 3. Running RuboCop linting..."
if ! bin/rubocop; then
    echo "âŒ RuboCop failed!"
    echo "ğŸ’¡ Run 'bin/rubocop -a' to auto-fix issues"
    exit 1
fi
echo "âœ… RuboCop passed!"
echo ""

echo "ğŸ§ª 4. Running tests..."
if ! bin/rails test; then
    echo "âŒ Tests failed!"
    exit 1
fi
echo "âœ… Tests passed!"
echo ""

echo "ğŸ‰ All CI checks passed! Ready to push! ğŸš€"
